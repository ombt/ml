SELECT 
    FD.ZIPID, 
    FD.FILEID, 
    FD.FILE_NAME, 
    E.ERROR_ID, 
    E.LAYOUT_NODES_ID, 
    E.NODEID, 
    E.NODETYPE,
    E.INSTANCEID,
    E.COMPLETIONDATE,
    E.ERRORCODE,
    E.SAMPLEID,
    E.MOREINFO,
    E.OFF_LINE,
    E.LOADDATE
FROM 
    IDAOWNER.A3600_LOG_FILES F, 
    IDAOWNER.A3600_LOG_FILE_DETAILS FD,
    (
        SELECT 
            ASI.DEVICEID, 
            AE.* 
        FROM 
            IDAOWNER.A3600_ERRORS  AE, 
            IDAOWNER.A3600_LAYOUT_NODES ALN, 
            IDAOWNER.A3600SYSTEMINFORMATION ASI
        WHERE 
            AE.LAYOUT_NODES_ID = ALN.LAYOUT_NODES_ID 
        AND 
            ALN.SYSTEMINFOID = ASI.SYSTEMINFOID 
        AND 
            COMPLETIONDATE > TRUNC(SYSDATE) - 31
    ) E  
WHERE 
    F.ZIPID = FD.ZIPID 
AND 
    FD.DEVICE_ID = E.DEVICEID 
-- AND 
    -- F.ZIPID BETWEEN 
        -- C_START_KEY 
    -- AND 
        -- C_END_KEY 
AND  
    F.PROCESSCODE ='P'
AND 
    SUBSTR(E.FILENAME,(LENGTH(E.FILENAME) - INSTR(REVERSE(E.FILENAME),'/')) + 2, LENGTH(E.FILENAME)) = FD.FILE_NAME;

select * from IDAOWNER.A3600SYSTEMINFORMATION limit 100

